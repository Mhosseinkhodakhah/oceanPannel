import{j as e,r as u,_ as p,ay as k,B as m,T as b,aF as M,az as O,o as g,L as P,D as R,C as N,H as T}from"./index-9aZS2Biy.js";import{C as _}from"./config-global-BiiB0tPS.js";import{u as G}from"./useQuery-z5woN8Ii.js";import{u as A}from"./useMutation-DsBzWsx7.js";import{A as z,a as B}from"./index.esm-C4PAhRlr.js";import{c as j}from"./client-Bn0KUMis.js";import{T as F,c as K,f as c,F as V,I as W,S as $,m as q}from"./validation-DvFZnTdr.js";import{I as E}from"./flag-icon-ChWWaGb0.js";import{S as v}from"./Stack-BjFKcEuv.js";import{I as H}from"./InputAdornment-DvH_qKZY.js";import{M as I}from"./MenuItem-B1VXGGez.js";import{D as Q,A as J}from"./Delete-CN5Arylp.js";import{D as U}from"./Divider-QW2c_N3U.js";const X=async()=>{try{const{data:r}=await j().get("/set-admin/app/get-all-admins");return r}catch(r){return console.log(r),r}},Y=async r=>{try{return await j().post("/set-admin/app/add-admin",r)}catch(s){return console.log(s),s}},Z=async r=>{try{return await j().delete(`/set-admin/app/delete-admin/${r}`)}catch(s){return console.log(s),s}},ee=async r=>{try{return await j().put(`/set-admin/app/suspend-admin/${r}`)}catch(s){return console.log(s),s}};function h({formik:r,name:s,label:f,multiline:i,type:x,size:a}){return e.jsx(F,{fullWidth:!0,size:a,type:x||"text",multiline:i,label:f,InputLabelProps:{shrink:!0,sx:{right:0,left:"unset",color:"#ffffff",transformOrigin:"right","&.MuiInputLabel-shrink":{transform:"translate(-5px, 10px) scale(0.75)"}}},sx:{mb:3,"& .MuiOutlinedInput-notchedOutline":{textAlign:"right",paddingRight:0},"& .MuiInputLabel-root":{position:"relative",transform:"none",padding:0},input:{color:"white"}},...r.getFieldProps(`${s}`)})}const te={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"#1F2936",color:"white",border:"2px solid #eaeaea",boxShadow:10,borderRadius:1,pt:2,px:4,pb:3};function se({isOpen:r,handleClose:s,refetch:f}){const[i,x]=u.useState(!1),a=A({mutationFn:Y,mutationKey:["createAdmin"],onSuccess:o=>{o!=null&&o.status?(p.success("ادمین با موفقیت اضافه شد",{position:"top-left"}),f(),s(),t.resetForm()):(s(),p.error("ادمین اضافه نشد ، لطفا دوباره امتحان کنید",{position:"top-left"}))}}),t=K({initialValues:{userName:"",firstName:"",lastName:"",phone:"",password:"",role:0},validationSchema:q,onSubmit:o=>{a.mutate(o)}});return e.jsx(k,{open:r,onClose:s,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(m,{sx:te,children:[e.jsx(b,{id:"modal-modal-title",variant:"h4",component:"h4",children:"ادمین جدید"}),e.jsxs("form",{onSubmit:t.handleSubmit,children:[e.jsx(h,{formik:t,label:"نام کاربری",name:"userName",type:"text"}),t.errors.userName&&e.jsx(c,{sx:{color:"red",textAlign:"right"},children:t.errors.userName}),e.jsxs(m,{sx:{display:"flex",gap:2,justifyContent:"space-between"},children:[e.jsxs(v,{sx:{width:"100%"},children:[e.jsx(h,{formik:t,label:"نام",name:"firstName",type:"text"}),t.errors.firstName&&e.jsx(c,{sx:{color:"red",textAlign:"right"},children:t.errors.firstName})]}),e.jsxs(v,{sx:{width:"100%"},children:[e.jsx(h,{formik:t,label:"نام خانوادگی",name:"lastName",type:"text"}),t.errors.lastName&&e.jsx(c,{sx:{color:"red",textAlign:"right"},children:t.errors.lastName})]})]}),e.jsx(h,{formik:t,label:"شماره تلفن",name:"phone",type:"number"}),t.errors.phone&&e.jsx(c,{sx:{color:"red",textAlign:"right"},children:t.errors.phone}),e.jsx(F,{fullWidth:!0,label:"رمز عبور",type:i?"text":"password",InputLabelProps:{shrink:!0,sx:{right:0,left:"unset",transformOrigin:"right","&.MuiInputLabel-shrink":{transform:"translate(-5px, 10px) scale(0.75)"},color:"#fff"}},InputProps:{endAdornment:e.jsx(H,{position:"end",children:e.jsx(M,{onClick:()=>x(!i),edge:"end",children:e.jsx(E,{icon:i?"solar:eye-bold":"solar:eye-closed-bold"})})})},sx:{mb:3,"& .MuiOutlinedInput-notchedOutline":{textAlign:"right",paddingRight:0},"& .MuiInputLabel-root":{position:"relative",transform:"none",padding:0},input:{color:"#ffffff"}},...t.getFieldProps("password")}),t.errors.password&&e.jsx(c,{sx:{color:"red",textAlign:"right"},children:t.errors.password}),e.jsxs(V,{fullWidth:!0,dir:"rlt",children:[e.jsx(W,{id:"demo-simple-select-label",sx:{textAlign:"right",width:"100%",position:"relative",right:-100,top:10,fontSize:20,color:"#ffffff"},children:"نقش"}),e.jsxs($,{labelId:"demo-simple-select-label",id:"demo-simple-select",variant:"outlined",value:t.values.role,defaultValue:t.values.role,onChange:o=>t.setFieldValue("role",o.target.value),sx:{mb:2,input:{color:"#ffffff"}},children:[e.jsx(I,{value:0,children:"ادمین"}),e.jsx(I,{value:1,children:"سوپر ادمین"})]})]}),t.errors.role&&e.jsx(c,{sx:{color:"red",textAlign:"right"},children:t.errors.role}),e.jsxs(m,{sx:{display:"flex",gap:4},children:[e.jsx(O,{variant:"contained",type:"submit",loading:a.isPending,sx:{flexGrow:1},children:"تایید"}),e.jsx(g,{variant:"outlined",color:"error",onClick:s,children:"انصراف"})]})]})]})})}const re=B;function ne(){const[r,s]=u.useState(""),[f,i]=u.useState(!1),[x,a]=u.useState(!1),[t,o]=u.useState(!1),l=()=>{i(!1),a(!1),o(!1)},[C,oe]=u.useState([{field:"userName",headerName:"نام کاربری"},{field:"firstName",headerName:"نام"},{field:"lastName",headerName:"نام خانوادگی"},{field:"role",headerName:"نقش",valueFormatter:n=>n.value===0?"Admin":"Super Admin"},{field:"actions",headerName:"عملیات",cellStyle:{minWidth:100},cellRenderer:n=>e.jsx(m,{sx:{display:"flex",gap:2,justifyContent:"end"},children:n.data.role===0?e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"contained",color:n.data.suspended?"success":"error",size:"small",onClick:()=>{s(n.data._id),o(!0)},children:n.data.suspended?"فعال سازی":"غیر فعال کردن"}),e.jsxs(g,{variant:"outlined",color:"error",size:"small",onClick:()=>{s(n.data._id),a(!0)},children:["حذف",e.jsx(Q,{})]})]}):e.jsx(b,{children:"-"})})}]),{data:d,isLoading:L,refetch:y}=G({queryKey:["getAllAdmin"],queryFn:X}),w=A({mutationKey:["deleteAdmin"],mutationFn:Z,onSuccess:n=>{console.log("vvv",n),n.status?(p.success("ادمین با موفقیت حذف شد",{position:"top-left"}),y(),l()):(p.error("ادمین حذف نشد ، لطفا دوباره امتحان کنید",{position:"top-left"}),l())}}),S=A({mutationKey:["suspendAdmin"],mutationFn:ee,onSuccess:n=>{console.log("vvv",n),n.status?(p.success("عملیات با موفقیت انجام شد",{position:"top-left"}),y(),l()):(p.error("عملیات انجام نشد ، لطفا دوباره امتحان کنید",{position:"top-left"}),l())}});console.log(d==null?void 0:d.data);const D=()=>{w.mutate(r)};return L?e.jsx(P,{}):e.jsxs(R,{children:[e.jsxs(m,{sx:{display:"flex",justifyContent:"space-between",py:4},children:[e.jsx(b,{variant:"h4",flexGrow:1,children:"ادمین"}),e.jsxs(g,{variant:"contained",onClick:()=>i(!0),children:["ادمین جدید",e.jsx(J,{})]})]}),e.jsx(U,{}),e.jsx(se,{isOpen:f,handleClose:l,refetch:y}),e.jsx(m,{className:"ag-theme-quartz-dark",style:{height:500,marginTop:20},children:e.jsx(z,{defaultColDef:{filter:!0,sortable:!0,cellStyle:{display:"flex",justifyContent:"center"}},rowData:(d==null?void 0:d.data)||[],columnDefs:C,gridOptions:{localeText:re},enableRtl:!0,pagination:!0})}),e.jsx(N,{title:"حذف ادمین",description:"آیا میخواهید ادمین را حذف کنید؟",handleClose:l,onSubmit:D,open:x,isLoading:w.isPending}),e.jsx(N,{title:"فعال/غیرفعال سازی ادمین",description:"آیا میخواهید ادمین را فعال/غیرفعال کنید؟",handleClose:l,onSubmit:()=>S.mutate(r),open:t,isLoading:S.isPending})]})}function ye(){return e.jsxs(e.Fragment,{children:[e.jsx(T,{children:e.jsxs("title",{children:[" ",`ادمین - ${_.appName}`]})}),e.jsx(ne,{})]})}export{ye as default};
