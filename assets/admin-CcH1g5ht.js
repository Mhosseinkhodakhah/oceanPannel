import{j as e,r as p,_ as m,ay as M,B as f,T as b,aH as O,az as k,o as g,L as P,D as R,C as v,H as T}from"./index-DdmGNYTu.js";import{C as _}from"./config-global-BiiB0tPS.js";import{u as G}from"./useQuery-CUHW0WWp.js";import{u as A}from"./useMutation-DmbTThdZ.js";import{A as z,a as B}from"./index.esm-Cvlo3cgR.js";import{c as j}from"./client-Osamek89.js";import{T as F,c as V,m as $,f as u,F as H,I as K,S as W}from"./validation-BgOpo_Gs.js";import{I as q}from"./flag-icon-CDE84eec.js";import{S as N}from"./Stack-XmdoteSJ.js";import{I as E}from"./InputAdornment-BYU68PEg.js";import{M as I}from"./MenuItem-CYhiyqCX.js";import{D as Q,A as J}from"./Delete-C5Q4y6sA.js";import{D as U}from"./Divider-BAtXe_Ik.js";const X=async()=>{try{const{data:r}=await j().get("/set-admin/app/get-all-admins");return r}catch(r){return console.log(r),r}},Y=async r=>{try{return await j().post("/set-admin/app/add-admin",r)}catch(s){return console.log(s),s}},Z=async r=>{try{return await j().delete(`/set-admin/app/delete-admin/${r}`)}catch(s){return console.log(s),s}},ee=async r=>{try{return await j().put(`/set-admin/app/suspend-admin/${r}`)}catch(s){return console.log(s),s}};function h({formik:r,name:s,label:x,multiline:i,type:d,size:a}){return e.jsx(F,{fullWidth:!0,size:a,type:d||"text",multiline:i,label:x,InputLabelProps:{shrink:!0,sx:{right:0,left:"unset",color:"#ffffff",transformOrigin:"right","&.MuiInputLabel-shrink":{transform:"translate(-5px, 10px) scale(0.75)"}}},sx:{mb:3,"& .MuiOutlinedInput-notchedOutline":{textAlign:"right",paddingRight:0},"& .MuiInputLabel-root":{position:"relative",transform:"none",padding:0},input:{color:"white"}},...r.getFieldProps(`${s}`),onChange:t=>{if(d==="phone"){const o=t.target.value.replace(/[^0-9]/g,"");r.setFieldValue(`${s}`,o)}}})}const te={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"#1F2936",color:"white",border:"2px solid #eaeaea",boxShadow:10,borderRadius:1,pt:2,px:4,pb:3};function se({isOpen:r,handleClose:s,refetch:x}){const[i,d]=p.useState(!1),a=A({mutationFn:Y,mutationKey:["createAdmin"],onSuccess:o=>{o!=null&&o.status?(m.success("ادمین با موفقیت اضافه شد",{position:"top-left"}),x(),s(),t.resetForm()):(s(),m.error("ادمین اضافه نشد ، لطفا دوباره امتحان کنید",{position:"top-left"}))}}),t=V({initialValues:{userName:"",firstName:"",lastName:"",phone:"",password:"",role:0},validationSchema:$,onSubmit:o=>{a.mutate(o)}});return e.jsx(M,{open:r,onClose:s,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(f,{sx:te,children:[e.jsx(b,{id:"modal-modal-title",variant:"h4",component:"h4",children:"ادمین جدید"}),e.jsxs("form",{onSubmit:t.handleSubmit,children:[e.jsx(h,{formik:t,label:"نام کاربری",name:"userName",type:"text"}),t.errors.userName&&e.jsx(u,{sx:{color:"red",textAlign:"right"},children:t.errors.userName}),e.jsxs(f,{sx:{display:"flex",gap:2,justifyContent:"space-between"},children:[e.jsxs(N,{sx:{width:"100%"},children:[e.jsx(h,{formik:t,label:"نام",name:"firstName",type:"text"}),t.errors.firstName&&e.jsx(u,{sx:{color:"red",textAlign:"right"},children:t.errors.firstName})]}),e.jsxs(N,{sx:{width:"100%"},children:[e.jsx(h,{formik:t,label:"نام خانوادگی",name:"lastName",type:"text"}),t.errors.lastName&&e.jsx(u,{sx:{color:"red",textAlign:"right"},children:t.errors.lastName})]})]}),e.jsx(h,{formik:t,label:"شماره تلفن",name:"phone",type:"phone"}),t.errors.phone&&e.jsx(u,{sx:{color:"red",textAlign:"right"},children:t.errors.phone}),e.jsx(F,{fullWidth:!0,label:"رمز عبور",type:i?"text":"password",InputLabelProps:{shrink:!0,sx:{right:0,left:"unset",transformOrigin:"right","&.MuiInputLabel-shrink":{transform:"translate(-5px, 10px) scale(0.75)"},color:"#fff"}},InputProps:{endAdornment:e.jsx(E,{position:"end",children:e.jsx(O,{onClick:()=>d(!i),edge:"end",children:e.jsx(q,{icon:i?"solar:eye-bold":"solar:eye-closed-bold"})})})},sx:{mb:3,"& .MuiOutlinedInput-notchedOutline":{textAlign:"right",paddingRight:0},"& .MuiInputLabel-root":{position:"relative",transform:"none",padding:0},input:{color:"#ffffff"}},...t.getFieldProps("password")}),t.errors.password&&e.jsx(u,{sx:{color:"red",textAlign:"right"},children:t.errors.password}),e.jsxs(H,{fullWidth:!0,dir:"rlt",children:[e.jsx(K,{id:"demo-simple-select-label",sx:{textAlign:"right",width:"100%",position:"relative",right:-100,top:10,fontSize:20,color:"#ffffff"},children:"نقش"}),e.jsxs(W,{labelId:"demo-simple-select-label",id:"demo-simple-select",variant:"outlined",value:t.values.role,defaultValue:t.values.role,onChange:o=>t.setFieldValue("role",o.target.value),sx:{mb:2,color:"#ffffff"},children:[e.jsx(I,{value:0,children:"ادمین"}),e.jsx(I,{value:1,children:"سوپر ادمین"})]})]}),t.errors.role&&e.jsx(u,{sx:{color:"red",textAlign:"right"},children:t.errors.role}),e.jsxs(f,{sx:{display:"flex",gap:4},children:[e.jsx(k,{variant:"contained",type:"submit",loading:a.isPending,sx:{flexGrow:1},children:"تایید"}),e.jsx(g,{variant:"outlined",color:"error",onClick:s,children:"انصراف"})]})]})]})})}const re=B;function ne(){const[r,s]=p.useState(""),[x,i]=p.useState(!1),[d,a]=p.useState(!1),[t,o]=p.useState(!1),l=()=>{i(!1),a(!1),o(!1)},[C,oe]=p.useState([{field:"userName",headerName:"نام کاربری"},{field:"firstName",headerName:"نام"},{field:"lastName",headerName:"نام خانوادگی"},{field:"role",headerName:"نقش",valueFormatter:n=>n.value===0?"Admin":"Super Admin"},{field:"actions",headerName:"عملیات",cellStyle:{minWidth:100},cellRenderer:n=>e.jsx(f,{sx:{display:"flex",gap:2,justifyContent:"end"},children:n.data.role===0?e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"contained",color:n.data.suspended?"success":"error",size:"small",onClick:()=>{s(n.data._id),o(!0)},children:n.data.suspended?"فعال سازی":"غیر فعال کردن"}),e.jsxs(g,{variant:"outlined",color:"error",size:"small",onClick:()=>{s(n.data._id),a(!0)},children:["حذف",e.jsx(Q,{})]})]}):e.jsx(b,{children:"-"})})}]),{data:c,isLoading:L,refetch:y}=G({queryKey:["getAllAdmin"],queryFn:X}),w=A({mutationKey:["deleteAdmin"],mutationFn:Z,onSuccess:n=>{console.log("vvv",n),n.status?(m.success("ادمین با موفقیت حذف شد",{position:"top-left"}),y(),l()):(m.error("ادمین حذف نشد ، لطفا دوباره امتحان کنید",{position:"top-left"}),l())}}),S=A({mutationKey:["suspendAdmin"],mutationFn:ee,onSuccess:n=>{console.log("vvv",n),n.status?(m.success("عملیات با موفقیت انجام شد",{position:"top-left"}),y(),l()):(m.error("عملیات انجام نشد ، لطفا دوباره امتحان کنید",{position:"top-left"}),l())}});console.log(c==null?void 0:c.data);const D=()=>{w.mutate(r)};return L?e.jsx(P,{}):e.jsxs(R,{children:[e.jsxs(f,{sx:{display:"flex",justifyContent:"space-between",py:4},children:[e.jsx(b,{variant:"h4",flexGrow:1,children:"ادمین"}),e.jsxs(g,{variant:"contained",onClick:()=>i(!0),children:["ادمین جدید",e.jsx(J,{})]})]}),e.jsx(U,{}),e.jsx(se,{isOpen:x,handleClose:l,refetch:y}),e.jsx(f,{className:"ag-theme-quartz-dark",style:{height:500,marginTop:20},children:e.jsx(z,{defaultColDef:{filter:!0,sortable:!0,cellStyle:{display:"flex",justifyContent:"center"}},rowData:(c==null?void 0:c.data)||[],columnDefs:C,gridOptions:{localeText:re},enableRtl:!0,pagination:!0})}),e.jsx(v,{title:"حذف ادمین",description:"آیا میخواهید ادمین را حذف کنید؟",handleClose:l,onSubmit:D,open:d,isLoading:w.isPending}),e.jsx(v,{title:"فعال/غیرفعال سازی ادمین",description:"آیا میخواهید ادمین را فعال/غیرفعال کنید؟",handleClose:l,onSubmit:()=>S.mutate(r),open:t,isLoading:S.isPending})]})}function ye(){return e.jsxs(e.Fragment,{children:[e.jsx(T,{children:e.jsxs("title",{children:[" ",`ادمین - ${_.appName}`]})}),e.jsx(ne,{})]})}export{ye as default};
